(function(){function g(){var a=document.querySelector("base");return a?a.getAttribute("href").replace(/\/$/,""):""}function m(){this.routes={};Object.defineProperty(this,"pathname",{enumerable:!0,get:function(){return location.pathname.replace(g(),"")},set:function(a){a="/"===a[0]?a:"/"+a;a=g()+a;history[h?"replaceState":"pushState"]({},document.title,a);h=!1;k()}})}function q(a){var b={regexp:a},c=b.keys=[];a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(a,b,l,e){a="?"===
e||"*?"===e?"?":null;e="*"===e||"*?"===e?"*":null;c.push({name:l,optional:!!a});b=b||"";return""+(a?"":b)+"(?:"+(a?b:"")+(e&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1");b.regexp=new RegExp("^"+a+"$");return b}function p(a){var b=new CustomEvent("routechange");window.dispatchEvent(b);a.handler&&a.handler()}function u(a,b){var c=new XMLHttpRequest,d=a.templateUrl,d="/"===d[0]?d:"/"+d;c.open("GET",g()+d,!0);c.onload=function(){200<=c.status&&400>c.status&&b(this.response)};
c.send()}function v(){var a=window.route,b=a.routes,c,d,f;for(f in b)if(b.hasOwnProperty(f)){var l=b[f],e;if(e=!d){c=l.keys;e={};if(l.regexp){var g=l.regexp.exec(a.pathname);if(g){for(var n=1,m=g.length;n<m;++n){var h=c[n-1],k=g[n];h&&k&&(e[h.name]=k)}c=e}else c=null}else c=null;e=c}e&&(d=l,a.params=c)}return d||b[null]}function k(){var a=v();if(a){var b=window.route;a.redirectTo?(h=!0,b.pathname=a.redirectTo):a.template?(b.template=a.template,p(a)):a.templateUrl?u(a,function(c){b.template=c;p(a)}):
p(a)}}function r(a){"loading"!=document.readyState?a():document.addEventListener("DOMContentLoaded",a)}function w(a){if(!(a.ctrlKey||a.shiftKey||a.metaKey)&&2!==a.button){for(var b=a.target;"A"!==b.nodeName;)if(b===document.body||!(b=b.parentNode))return;var c=b.href,d=b.getAttribute("href");if(!x.test(c)&&c&&!b.getAttribute("target")&&!a.defaultPrevented){var f;d&&"#"===d[0]?(location.hash=d.slice(1),f=!0):(d=t,c=0===c.lastIndexOf(d,0)?c.substr(d.length):void 0,"undefined"!==typeof c&&(f=t+c),f=
!!f);f&&(a.preventDefault(),location.pathname!==b.pathname&&(window.route.pathname=b.pathname.replace(g(),"")))}}}var h=!1;m.prototype.when=function(a,b){if(a){var c=q(a);b.regexp=c.regexp;b.keys=c.keys}this.routes[a]=b;if(a){var d="/"===a[a.length-1]?a.substr(0,a.length-1):a+"/",c=q(d);this.routes[d]={redirectTo:a,regexp:c.regexp,keys:c.keys}}return this};m.prototype.otherwise=function(a){"string"===typeof a&&(a={redirectTo:a});this.when(null,a);return this};window.route=new m;window.addEventListener("popstate",
k);r(k);window.addEventListener("routechange",function(){var a=window.route,b=document.querySelector("[data-view]");b&&(b.innerHTML=a.template,a=new CustomEvent("viewcontentloaded"),b.dispatchEvent(a))});var x=/^\s*(javascript|mailto):/i,t=function(a){return a.substring(0,a.indexOf("/",a.indexOf("//")+2))}(location.href)+(function(){var a=document.querySelector("base").getAttribute("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""}()||"/");r(function(){document.body.addEventListener("click",
w)})})();
