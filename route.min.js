(function(){function g(){var a=document.querySelector("base");return a?a.getAttribute("href").replace(/\/$/,""):""}function f(){this.routes={};Object.defineProperty(this,"pathname",{enumerable:!0,get:function(){return location.pathname.replace(g(),"")},set:function(a){a="/"===a[0]?a:"/"+a;a=g()+a;history.pushState({},document.title,a);h()}})}function p(a){var b={originalPath:a,regexp:a},c=b.keys=[];a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(a,b,f,e){a="?"===e||"*?"===
e?"?":null;e="*"===e||"*?"===e?"*":null;c.push({name:f,optional:!!a});b=b||"";return""+(a?"":b)+"(?:"+(a?b:"")+(e&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1");b.regexp=new RegExp("^"+a+"$");return b}function k(a){a.handler&&a.handler();a=new CustomEvent("routechange");window.dispatchEvent(a)}function q(a,b){var c=new XMLHttpRequest,d=a.templateUrl,d="/"===d[0]?d:"/"+d;c.open("GET",g()+d,!0);c.onload=function(){200<=c.status&&400>c.status&&b(this.response)};c.send()}function r(){var a=
window.route,b=a.routes,c,d,f;for(f in b)if(b.hasOwnProperty(f)){var g=b[f],e;if(e=!d){c=g.keys;e={};if(g.regexp){var h=g.regexp.exec(a.pathname);if(h){for(var m=1,k=h.length;m<k;++m){var l=c[m-1],n=h[m];l&&n&&(e[l.name]=n)}c=e}else c=null}else c=null;e=c}e&&(d=g,a.params=c)}return d||b[null]}function h(){var a=r();a&&(a.redirectTo?f.pathname=a.redirectTo:a.template?(f.template=a.template,k(a)):a.templateUrl?q(a,function(b){f.template=b;k(a)}):k(a))}function l(a){"loading"!=document.readyState?a():
document.addEventListener("DOMContentLoaded",a)}function t(a){if(!(a.ctrlKey||a.shiftKey||a.metaKey)&&2!==a.button){for(var b=a.target;"A"!==b.nodeName;)if(b===document.body||!(b=b.parentNode))return;var c=b.href,d=b.getAttribute("href");u.test(c)||!c||b.getAttribute("target")||a.defaultPrevented||(a.preventDefault(),a="/"===d[0]?d:"/"+d,location.pathname!==g()+a&&(window.route.pathname=a))}}f.prototype.when=function(a,b){var c=p(a);b.originalPath=c.originalPath;b.regexp=c.regexp;b.keys=c.keys;this.routes[a]=
b;return this};f.prototype.otherwise=function(a){"string"===typeof a&&(a={redirectTo:a});this.when(null,a);return this};window.route=new f;window.addEventListener("popstate",h);l(h);window.addEventListener("routechange",function(){var a=window.route,b=document.querySelector("[data-view]");b&&(b.innerHTML=a.template,a=new CustomEvent("viewcontentloaded"),b.dispatchEvent(a))});var u=/^\s*(javascript|mailto):/i;l(function(){document.body.addEventListener("click",t)})})();
