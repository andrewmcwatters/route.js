(function(){function f(){var a=document.querySelector("base");return a?a.getAttribute("href").replace(/\/$/,""):""}function g(){this.routes={};Object.defineProperty(this,"pathname",{enumerable:!0,get:function(){return location.pathname.replace(f(),"")},set:function(a){a="/"===a[0]?a:"/"+a;a=f()+a;history.pushState({},document.title,a);l()}})}function p(a){var b={originalPath:a,regexp:a},c=b.keys=[];a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(a,b,h,e){a="?"===e||"*?"===
e?"?":null;e="*"===e||"*?"===e?"*":null;c.push({name:h,optional:!!a});b=b||"";return""+(a?"":b)+"(?:"+(a?b:"")+(e&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1");b.regexp=new RegExp("^"+a+"$");return b}function k(a){a.handler&&a.handler();a=new CustomEvent("routechange");window.dispatchEvent(a)}function q(a,b){var c=new XMLHttpRequest,d=a.templateUrl,d="/"===d[0]?d:"/"+d;c.open("GET",f()+d,!0);c.onload=function(){200<=c.status&&400>c.status&&b(this.response)};c.send()}function r(){var a=
window.route,b=a.routes,c,d,f;for(f in b)if(b.hasOwnProperty(f)){var h=b[f],e;if(e=!d){c=h.keys;e={};if(h.regexp){var g=h.regexp.exec(a.pathname);if(g){for(var n=1,l=g.length;n<l;++n){var k=c[n-1],m=g[n];k&&m&&(e[k.name]=m)}c=e}else c=null}else c=null;e=c}e&&(d=h,a.params=c)}return d||b[null]}function l(){var a=r();if(a){var b=window.route;a.redirectTo?b.pathname=a.redirectTo:a.template?(b.template=a.template,k(a)):a.templateUrl?q(a,function(c){b.template=c;k(a)}):k(a)}}function m(a){"loading"!=document.readyState?
a():document.addEventListener("DOMContentLoaded",a)}function t(a){if(!(a.ctrlKey||a.shiftKey||a.metaKey)&&2!==a.button){for(var b=a.target;"A"!==b.nodeName;)if(b===document.body||!(b=b.parentNode))return;var c=b.href,d=b.getAttribute("href");u.test(c)||!c||b.getAttribute("target")||a.defaultPrevented||(a.preventDefault(),a="/"===d[0]?d:"/"+d,location.pathname!==f()+a&&(window.route.pathname=a))}}g.prototype.when=function(a,b){var c=p(a);b.originalPath=c.originalPath;b.regexp=c.regexp;b.keys=c.keys;
this.routes[a]=b;return this};g.prototype.otherwise=function(a){"string"===typeof a&&(a={redirectTo:a});this.when(null,a);return this};window.route=new g;window.addEventListener("popstate",l);m(l);window.addEventListener("routechange",function(){var a=window.route,b=document.querySelector("[data-view]");b&&(b.innerHTML=a.template,a=new CustomEvent("viewcontentloaded"),b.dispatchEvent(a))});var u=/^\s*(javascript|mailto):/i;m(function(){document.body.addEventListener("click",t)})})();
