(function(){function g(){var a=document.querySelector("base");return a?a.getAttribute("href").replace(/\/$/,""):""}function l(){this.routes={};Object.defineProperty(this,"pathname",{enumerable:!0,get:function(){return location.pathname.replace(g(),"")},set:function(a){a="/"===a[0]?a:"/"+a;a=g()+a;history.pushState({},document.title,a);m()}})}function t(a){var b={regexp:a},c=b.keys=[];a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(a,b,f,e){a="?"===e||"*?"===e?"?":null;
e="*"===e||"*?"===e?"*":null;c.push({name:f,optional:!!a});b=b||"";return""+(a?"":b)+"(?:"+(a?b:"")+(e&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1");b.regexp=new RegExp("^"+a+"$");return b}function p(a){a.handler&&a.handler();a=new CustomEvent("routechange");window.dispatchEvent(a)}function u(a,b){var c=new XMLHttpRequest,d=a.templateUrl,d="/"===d[0]?d:"/"+d;c.open("GET",g()+d,!0);c.onload=function(){200<=c.status&&400>c.status&&b(this.response)};c.send()}function v(){var a=
window.route,b=a.routes,c,d,k;for(k in b)if(b.hasOwnProperty(k)){var f=b[k],e;if(e=!d){c=f.keys;e={};if(f.regexp){var g=f.regexp.exec(a.pathname);if(g){for(var h=1,n=g.length;h<n;++h){var l=c[h-1],m=g[h];l&&m&&(e[l.name]=m)}c=e}else c=null}else c=null;e=c}e&&(d=f,a.params=c)}return d||b[null]}function m(){var a=v();if(a){var b=window.route;a.redirectTo?b.pathname=a.redirectTo:a.template?(b.template=a.template,p(a)):a.templateUrl?u(a,function(c){b.template=c;p(a)}):p(a)}}function q(a){"loading"!=document.readyState?
a():document.addEventListener("DOMContentLoaded",a)}function r(a,b){if(0===b.lastIndexOf(a,0))return b.substr(a.length)}function w(a){if(!(a.ctrlKey||a.shiftKey||a.metaKey)&&2!==a.button){for(var b=a.target;"A"!==b.nodeName;)if(b===document.body||!(b=b.parentNode))return;var c=b.href,d=b.getAttribute("href");if(!x.test(c)&&c&&!b.getAttribute("target")&&!a.defaultPrevented){if(d&&"#"===d[0])location.hash=d.slice(1),b=!0;else{var k,f;"undefined"!==typeof(k=r(h,c))?f=h+k:"undefined"!==typeof(k=r(n,c))?
f=n+k:n===c+"/"&&(f=n);b=!!f}b&&(a.preventDefault(),a="/"===d[0]?d:"/"+d,location.pathname!==g()+a&&(window.route.pathname=a))}}}l.prototype.when=function(a,b){var c=t(a);b.regexp=c.regexp;b.keys=c.keys;this.routes[a]=b;return this};l.prototype.otherwise=function(a){"string"===typeof a&&(a={redirectTo:a});this.when(null,a);return this};window.route=new l;window.addEventListener("popstate",m);q(m);window.addEventListener("routechange",function(){var a=window.route,b=document.querySelector("[data-view]");
b&&(b.innerHTML=a.template,a=new CustomEvent("viewcontentloaded"),b.dispatchEvent(a))});var x=/^\s*(javascript|mailto):/i,h=function(a){return a.substring(0,a.indexOf("/",a.indexOf("//")+2))}(location.href)+(g()||"/"),n=h.substr(0,function(a){var b=a.indexOf("#");return-1===b?a:a.substr(0,b)}(h).lastIndexOf("/")+1);q(function(){document.body.addEventListener("click",w)})})();
