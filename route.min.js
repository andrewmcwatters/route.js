(function(){function h(){var a=document.querySelector("base");return a?a.getAttribute("href").replace(/\/$/,""):""}function v(a){return a.replace(/[?]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function l(){this.routes={};Object.defineProperty(this,"pathname",{enumerable:!0,get:function(){return location.pathname.replace(h(),"")},set:function(a){a="/"===a[0]?a:"/"+a;a=h()+a;a=v(a);history[f?"replaceState":"pushState"]({},document.title,a);f=!1;k()}})}function q(a){var b=
{regexp:a},c=b.keys=[];a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(a,b,g,e){a="?"===e||"*?"===e?"?":null;e="*"===e||"*?"===e?"*":null;c.push({name:g,optional:!!a});b=b||"";return""+(a?"":b)+"(?:"+(a?b:"")+(e&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1");b.regexp=new RegExp("^"+a+"$");return b}function p(a){var b=new CustomEvent("routechange");window.dispatchEvent(b);a.handler&&a.handler()}function w(a,b){var c=new XMLHttpRequest,d=a.templateUrl,
d="/"===d[0]?d:"/"+d;c.open("GET",h()+d,!0);c.onload=function(){200<=c.status&&400>c.status&&b(this.response)};c.send()}function x(){var a=window.route,b=a.routes,c,d,n;for(n in b)if(b.hasOwnProperty(n)){var g=b[n],e;if(e=!d){c=g.keys;e={};if(g.regexp){var h=g.regexp.exec(a.pathname);if(h){for(var m=1,l=h.length;m<l;++m){var f=c[m-1],k=h[m];f&&k&&(e[f.name]=k)}c=e}else c=null}else c=null;e=c}e&&(d=g,a.params=c)}return d||b[null]}function k(){var a=x();if(a){var b=window.route;a.redirectTo?(f=!0,b.pathname=
a.redirectTo):a.template?(b.template=a.template,p(a)):a.templateUrl?w(a,function(c){b.template=c;p(a)}):p(a)}}function r(a){"loading"!=document.readyState?a():document.addEventListener("DOMContentLoaded",a)}function t(a,b){if(0===b.lastIndexOf(a,0))return b.substr(a.length)}function y(a){if(!(a.ctrlKey||a.shiftKey||a.metaKey)&&2!==a.button){for(var b=a.target;"A"!==b.nodeName;)if(b===document.body||!(b=b.parentNode))return;var c=b.href,d=b.getAttribute("href");if(!z.test(c)&&c&&!b.getAttribute("target")&&
!a.defaultPrevented){if(d&&"#"===d[0])location.hash=d.slice(1),c=!1;else{var f,g;"undefined"!==typeof(f=t(u,c))&&(g=u+f);c=!!g}c&&(a.preventDefault(),location.pathname!==b.pathname&&(a=b.pathname,a=t(h(),a)||a,window.route.pathname=a))}}}var f=!1;l.prototype.when=function(a,b){if(a){var c=q(a);b.regexp=c.regexp;b.keys=c.keys}this.routes[a]=b;if(a){var d="/"===a[a.length-1]?a.substr(0,a.length-1):a+"/",c=q(d);this.routes[d]={redirectTo:a,regexp:c.regexp,keys:c.keys}}return this};l.prototype.otherwise=
function(a){"string"===typeof a&&(a={redirectTo:a});this.when(null,a);return this};window.route=new l;window.addEventListener("popstate",k);r(k);window.addEventListener("routechange",function(){var a=window.route,b=document.querySelector("[data-view]");b&&(b.innerHTML=a.template,setTimeout(function(){var a=new CustomEvent("viewcontentloaded");b.dispatchEvent(a)}))});var z=/^\s*(javascript|mailto):/i,u=document.querySelector("base").href;r(function(){document.body.addEventListener("click",y)})})();
